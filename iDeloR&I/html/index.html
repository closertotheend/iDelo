<!DOCTYPE html>
<!--[if IE 8]>
<html class="no-js lt-ie9" xmlns:ng="http://angularjs.org" id="ng-app" ng-app="iDeloApp"> 
<![endif]-->
<!--[if gt IE 8]><!--> 
<html class="no-js" ng-app="iDeloApp" lang="en">
<!--<![endif]-->
<head>
<title>Welcome to Molvania iDelo!</title>

<!-- META -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title ng-bind="header"></title>
<meta name="description" content="">

<!-- MODULES -->
<script src="../libs/jquery/jquery.min.js"></script>

<script src="../libs/bootstrap/js/bootstrap.min.js"></script>
<link href="../libs/bootstrap/css/bootstrap.min.css" rel="stylesheet">

<link href="../libs/tags/tagmanager.css" rel="stylesheet">

<script src="../libs/angular/angular.min.js"></script>
<script src="../libs/angular/angular-route.min.js"></script>

<script src="../libs/datetimepicker/jquery.datetimepicker.js"></script>
<script src="../libs/bootstrap-tags/js/bootstrap-tags.js"></script>
<link href="../libs/datetimepicker/jquery.datetimepicker.css"
	rel="stylesheet">
	
<link href="../libs/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link type="text/css"
	href="../libs/bootstrap-tags/css/bootstrap-tags.css" rel="stylesheet" />



<!-- CSS -->
<link href="../css/common/common.css" rel="stylesheet">
<link href="../css/common/navbar-fixed-top.css" rel="stylesheet">

<!-- JS -->
<script src="../js/common/mapUtil.js"></script>
<script src="../js/common/smartNavbar.js"></script>
<script src="../js/common/smartFooter.js"></script>
<script src="../js/app.js"></script>
<script src="../js/controllers.js"></script>

<script>
        var crimeTags;
        var mapLng;
        var mapLtd;
        $(document).ready($.getJSON("json/complaints.json", function (data) {

            complaintInfo = '<div class="row"><div class="col-md-9">';
            var complaint = data['complaints'][0];
            complaintInfo += '<dl><dt>Episode:</dt><dd>' + complaint.episode + '</dd>';
            complaintInfo += '<dt>Date & Time:</dt><dd>' + complaint.dateTime + '</dd>';
            complaintInfo += '<dt>Tags:</dt><dd><div id="readOnlyTags" class="bootstrap-tags bootstrap-3">';
            complaintInfo += '<div class="tags">'

            for (i = 0; i < complaint.tags.length; i++) {
                complaintInfo += '<div class="tag label btn-info md"> <span>&nbsp;&nbsp; ' + complaint.tags[i] + '&nbsp;&nbsp;</span>      </div>'
            }

            complaintInfo += '</div></div></dd><br><br>';
            complaintInfo += '<dt>Description:</dt><dd>' + complaint.description +'</dd>'

            mapLtd = complaint.location.lat;
            mapLng = complaint.location.lng;

            complaintInfo += '<dt>Location:</dt><dd><div id="map_canvas"></div></dd>'

            complaintInfo += '<dt>Images:<dd><div class="row">';

            for ( i = 0; i < complaint.images.length; i++) {
                complaintInfo += '<div class="col-xs-3"><a href="' + complaint.images[i] +'" class="thumbnail" target="_blank"><img class="img-responsive" src="' +  complaint.images[i] +'"></a></div>';
            }
            complaintInfo += '</div></dd></dt>'
            complaintInfo +=  '</dl></div>' ;


            loadScript();
            $('#complaint').append(complaintInfo);

        }));

        function loadScript() {
            var script = document.createElement('script');
            script.type = 'text/javascript';

            script.src = 'https://maps.googleapis.com/maps/api/js?v=AIzaSyCzYjvCXkNylxgzNlWHmuWwSmJmWeqm61k&sensor=false&' +
                    'callback=loadMapWrapper';
            document.body.appendChild(script);
        }
        // workaround to place into callback
        function loadMapWrapper() {
            initDisplayMap(mapLtd, mapLng);
        }
</script>
</head>

<body>
	<div class="container">
		<div ng-include="'includes/common/navbar.html'"></div>
		<div class="view-container">
			<div ng-view="" class="view-frame"></div>
		</div>
		<hr>
		<div ng-include="'includes/common/footer.html'"></div>
	</div>
</body>
</html>
